<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penalty Shootout</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-green-700 font-sans">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { createRoot } = ReactDOM;

        // The main App component that contains the entire game
        const App = () => {
            const [gameState, setGameState] = useState('start'); // 'start', 'kicking', 'goal', 'save', 'gameover'
            const [userScore, setUserScore] = useState(0);
            const [computerScore, setComputerScore] = useState(0);
            const [goalkeeperPosition, setGoalkeeperPosition] = useState('center');
            const [message, setMessage] = useState('');
            const [kickerChoice, setKickerChoice] = useState(null);
            const [shotResult, setShotResult] = useState(null);
            const [round, setRound] = useState(0); // Tracks current round (0-4)
            const [userShotHistory, setUserShotHistory] = useState([]); // Tracks user's goals and saves
            const [computerShotHistory, setComputerShotHistory] = useState([]); // Tracks computer's goals and saves
            const [isUserTurn, setIsUserTurn] = useState(true);
            const maxRounds = 5;
            const goalkickTimer = useRef(null);

            // Returns a random position for a save or kick
            const getRandomPosition = () => {
                const positions = ['left', 'center', 'right'];
                return positions[Math.floor(Math.random() * positions.length)];
            };

            const startGame = () => {
                setUserScore(0);
                setComputerScore(0);
                setRound(0);
                setUserShotHistory([]);
                setComputerShotHistory([]);
                setIsUserTurn(true);
                setGameState('kicking');
                setMessage('It\'s your turn to kick! Choose your shot!');
            };

            const handleUserAction = (choice) => {
                if (gameState !== 'kicking') return;
                
                if (isUserTurn) {
                    // User is the kicker
                    setKickerChoice(choice);
                    const savePosition = getRandomPosition();
                    setGoalkeeperPosition(savePosition);

                    setTimeout(() => {
                        if (choice === savePosition) {
                            setShotResult('save');
                            setMessage('Neelama made a great save!');
                            setUserShotHistory(prev => [...prev, 'save']);
                        } else {
                            setShotResult('goal');
                            setMessage('GOOOOAL! You scored!');
                            setUserScore(userScore + 1);
                            setUserShotHistory(prev => [...prev, 'goal']);
                        }
                        setGameState('completed_shot');
                    }, 2100);
                } else {
                    // User is the goalkeeper
                    const kickPosition = getRandomPosition();
                    setKickerChoice(kickPosition);
                    setGoalkeeperPosition(choice);
                    clearTimeout(goalkickTimer.current);

                    setTimeout(() => {
                        if (choice === kickPosition) {
                            setShotResult('save');
                            setMessage('You made an incredible save!');
                            setComputerShotHistory(prev => [...prev, 'save']);
                        } else {
                            setShotResult('goal');
                            setMessage('The ball flew past you! GOOOOAL!');
                            setComputerScore(computerScore + 1);
                            setComputerShotHistory(prev => [...prev, 'goal']);
                        }
                        setGameState('completed_shot');
                    }, 400); // Shorter delay for quick feedback
                }
            };

            const nextShot = () => {
                setKickerChoice(null);
                setGoalkeeperPosition('center');
                if (round < maxRounds) {
                    // Toggle turn and advance the round
                    setIsUserTurn(!isUserTurn);
                    if (!isUserTurn) { // If it was the computer's turn, the round is over
                         setRound(round + 1);
                    }
                    
                    if (isUserTurn) {
                        setMessage('It\'s your turn to kick! Choose your shot!');
                        setGameState('kicking');
                    } else {
                         setMessage('It\'s Neelama\'s turn to kick. Choose a direction!');
                         setGameState('kicking');
                         goalkickTimer.current = setTimeout(() => handleUserAction(getRandomPosition()), 2000);
                    }
                } else {
                    // Game over
                    setGameState('gameover');
                    if (userScore > computerScore) {
                        setMessage(`You won the match! Final score: ${userScore} - ${computerScore}.`);
                    } else if (computerScore > userScore) {
                        setMessage(`You lost the match. Final score: ${userScore} - ${computerScore}.`);
                    } else {
                        setMessage(`It's a draw! Final score: ${userScore} - ${computerScore}.`);
                    }
                }
            };

            const restartGame = () => {
                setGameState('start');
                setGoalkeeperPosition('center');
                setKickerChoice(null);
                setShotResult(null);
                setMessage('');
                startGame(); // Automatically start a new game
            };

            useEffect(() => {
                if (gameState === 'start') {
                    setMessage('You are about to play a match with Neelama.');
                }
            }, [gameState]);

            useEffect(() => {
                return () => clearTimeout(goalkickTimer.current);
            }, []);

            const Player = ({ role, isUserTurn, position }) => {
                const isOpponent = (role === 'kicker' && !isUserTurn) || (role === 'goalkeeper' && isUserTurn);

                const getPositionClass = () => {
                    if (role === 'kicker') {
                        return 'bottom-16';
                    }
                    switch (position) {
                        case 'left': return 'translate-x-[-10rem] md:translate-x-[-15rem]';
                        case 'right': return 'translate-x-[10rem] md:translate-x-[15rem]';
                        case 'center': return 'translate-x-0';
                        default: return 'translate-x-0';
                    }
                };

                const getContainerClass = () => {
                    if (role === 'kicker') {
                        return 'bottom-16';
                    } else {
                        return 'bottom-40';
                    }
                };

                return (
                    <div className={`
                        absolute transition-transform duration-300 ease-in-out
                        ${getContainerClass()}
                        ${getPositionClass()}
                        w-20 h-20 md:w-28 md:h-28 rounded-full overflow-hidden
                    `}>
                        {isOpponent ? (
                            <img 
                                src="https://i.ibb.co/Lzbch83h/Screenshot-2025-08-29-171211.png" 
                                alt="Opponent" 
                                className="w-full h-full object-cover"
                            />
                        ) : (
                            <div className="w-full h-full bg-slate-800 flex items-center justify-center text-white">
                                <span className="text-xl md:text-2xl font-bold">YOU</span>
                            </div>
                        )}
                    </div>
                );
            };

            const Ball = ({ choice, result }) => {
                const getShotClass = () => {
                    if (!choice) return 'bottom-16';
                    switch (choice) {
                        case 'left': return 'translate-x-[-10rem] md:translate-x-[-15rem] -bottom-28';
                        case 'right': return 'translate-x-[10rem] md:translate-x-[15rem] -bottom-28';
                        case 'center': return 'translate-x-0 -bottom-28';
                        default: return 'bottom-16'; // Initial position
                    }
                };
                
                const getDurationClass = () => isUserTurn ? 'duration-2000' : 'duration-300';

                return (
                    <div className={`
                        absolute left-1/2 transform -translate-x-1/2
                        transition-all ease-out
                        ${getDurationClass()}
                        ${getShotClass()}
                        w-10 h-10 md:w-12 md:h-12 bg-gray-500 rounded-full border-2 border-gray-900
                        ${result === 'goal' ? 'animate-pulse' : ''}
                    `}>
                    </div>
                );
            };

            const Scorecard = ({ history, isUser }) => (
                <div className="flex justify-center items-center space-x-2 md:space-x-4">
                    {Array.from({ length: maxRounds }).map((_, index) => {
                        const shot = history[index];
                        const getShotColor = () => {
                            if (shot === 'goal') {
                                return isUser ? 'bg-green-600' : 'bg-red-600';
                            } else if (shot === 'save') {
                                return isUser ? 'bg-red-600' : 'bg-green-600';
                            }
                            return 'bg-gray-300';
                        };
                        return (
                            <div 
                                key={index} 
                                className={`
                                    w-6 h-6 md:w-8 md:h-8 rounded-full 
                                    border-2 border-green-900
                                    ${getShotColor()}
                                    transition-colors duration-300 ease-in-out
                                `}
                            ></div>
                        );
                    })}
                </div>
            );

            return (
                <div className="bg-green-700 min-h-screen flex flex-col items-center justify-center p-4">
                    <div className="bg-white rounded-xl shadow-2xl p-6 md:p-10 w-full max-w-2xl text-center">
                        <h1 className="text-4xl md:text-5xl font-extrabold text-green-900 mb-4">
                            Penalty Shootout
                        </h1>
                        <div className="flex justify-around items-center w-full mb-4">
                            <div className="flex flex-col items-center">
                                <h2 className="text-2xl font-bold text-gray-800">You</h2>
                                <p className="text-3xl font-extrabold text-gray-800">{userScore}</p>
                                <Scorecard history={userShotHistory} isUser={true} />
                            </div>
                            <div className="flex flex-col items-center">
                                <h2 className="text-2xl font-bold text-gray-800">Neelama</h2>
                                <p className="text-3xl font-extrabold text-gray-800">{computerScore}</p>
                                <Scorecard history={computerShotHistory} isUser={false} />
                            </div>
                        </div>

                        <div className="text-xl md:text-2xl font-semibold text-gray-600 mb-6">
                            Round: {round + 1} / {maxRounds}
                        </div>
                        <p className="text-lg md:text-xl font-medium text-gray-700 mb-8 h-10">
                            {message}
                        </p>

                        {/* Game state rendering */}
                        {gameState === 'start' && (
                            <div className="flex justify-center">
                                <button
                                    onClick={startGame}
                                    className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition transform hover:scale-105"
                                >
                                    Start Match
                                </button>
                            </div>
                        )}

                        {(gameState === 'kicking' || gameState === 'completed_shot') && (
                            <>
                                {/* The Football Pitch */}
                                <div className="relative w-full h-80 md:h-96 bg-green-500 rounded-xl overflow-hidden mb-8">
                                    {/* Goal posts */}
                                    <div className="absolute top-0 left-1/2 transform -translate-x-1/2 w-80 md:w-96 h-40 md:h-52 border-4 border-white rounded-b-xl border-t-0 bg-white bg-opacity-10 backdrop-filter backdrop-blur-sm shadow-inner">
                                        <div className="absolute top-0 left-0 w-full h-full bg-black bg-opacity-20 flex justify-center items-center rounded-b-xl">
                                            <div className="relative w-64 md:w-80 h-32 md:h-40 border-2 border-white">
                                                {/* Netting lines */}
                                                <div className="absolute top-0 w-1/3 h-full border-l border-white"></div>
                                                <div className="absolute top-0 w-2/3 h-full border-l border-white"></div>
                                                <div className="absolute top-0 left-0 h-1/3 w-full border-t border-white"></div>
                                                <div className="absolute top-0 left-0 h-2/3 w-full border-t border-white"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {/* Goalkeeper and Kicker */}
                                    <Player 
                                        isUserTurn={isUserTurn}
                                        role="kicker"
                                    />
                                    <Player 
                                        isUserTurn={isUserTurn}
                                        role="goalkeeper"
                                        position={goalkeeperPosition}
                                    />
                                    <Ball choice={kickerChoice} result={shotResult} />
                                </div>

                                {/* Action Buttons */}
                                <div className="flex justify-center space-x-4 md:space-x-8">
                                    {gameState === 'kicking' && (
                                        <>
                                            <button
                                                onClick={() => handleUserAction('left')}
                                                className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition transform hover:scale-105"
                                            >
                                                {isUserTurn ? 'Kick Left' : 'Dive Left'}
                                            </button>
                                            <button
                                                onClick={() => handleUserAction('center')}
                                                className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition transform hover:scale-105"
                                            >
                                                {isUserTurn ? 'Kick Center' : 'Stay Center'}
                                            </button>
                                            <button
                                                onClick={() => handleUserAction('right')}
                                                className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition transform hover:scale-105"
                                            >
                                                {isUserTurn ? 'Kick Right' : 'Dive Right'}
                                            </button>
                                        </>
                                    )}

                                    {gameState === 'completed_shot' && round < maxRounds && (
                                        <button
                                            onClick={nextShot}
                                            className="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition transform hover:scale-105"
                                        >
                                            Next Shot
                                        </button>
                                    )}

                                    {round === maxRounds && (
                                        <button
                                            onClick={restartGame}
                                            className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition transform hover:scale-105"
                                        >
                                            Play Again
                                        </button>
                                    )}
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        };

        const rootElement = document.getElementById('root');
        const root = createRoot(rootElement);
        root.render(<App />);

    </script>
</body>
</html>
